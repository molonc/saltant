<script>
	// Protect against no data
	var no_data_plugin = {
		afterDraw: function(chart) {
			if (chart.data.datasets[0].data.every(a => a === 0)) {
				// No data is present
				var ctx = chart.chart.ctx
				var width = chart.chart.width
				var height = chart.chart.height
				chart.clear()

				ctx.save()
				ctx.textAlign = 'center'
				ctx.textBaseline = 'middle'
				ctx.font = ctx.font.replace(/\d+px/, "11px")
				ctx.fillStyle = "#bbbbbb"
				ctx.fillText('no jobs from this past week = no pie chart', width / 2, height / 2)
				ctx.restore()
			}
		}
	}
	var ctx = document.getElementById("job-pie-chart").getContext('2d');

	// Instantiate pie chart
	var myPieChart = new Chart(ctx, {
		type: 'pie',
		data: {
			labels: {{ labels|safe }},
			datasets: {{ datasets|safe }}
		},
		options: {
			legend: {
				position: 'right',
			},
			title: {
				display: true,
				position: 'right',
				text: 'last week\'s jobs'
			}
		},
		plugins: [no_data_plugin]
	});
</script>
